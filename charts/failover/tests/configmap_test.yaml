suite: Ignition Failover ConfigMaps
templates:
  - configmap.yaml
  - configmap-scripts.yaml
  - configmap-ignition-files.yaml
tests:
  - it: should create main configmap
    template: configmap.yaml
    asserts:
      - isKind:
          of: ConfigMap
      - equal:
          path: metadata.name
          value: ignition-failover-config

  - it: should populate configmap with env vars
    template: configmap.yaml
    set:
      ignition:
        config:
          CUSTOM_VAR: "custom_value"
    asserts:
      - equal:
          path: data.CUSTOM_VAR
          value: "custom_value"

  - it: should create scripts secret
    template: configmap-scripts.yaml
    asserts:
      - isKind:
          of: Secret
      - matchRegex:
          path: metadata.name
          pattern: -scripts$

  - it: should create files configmap
    template: configmap-ignition-files.yaml
    asserts:
      - isKind:
          of: ConfigMap
      - matchRegex:
          path: metadata.name
          pattern: -files$
