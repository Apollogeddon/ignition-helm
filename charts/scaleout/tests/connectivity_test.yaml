suite: Ignition Scaleout Connectivity
templates:
  - templates/frontend/frontend-statefulset.yaml
tests:
  - it: should inject backend GAN hosts into frontend when backend redundancy is enabled
    set:
      backend:
        redundancy:
          enabled: true
    asserts:
      - contains:
          path: spec.template.spec.containers[0].env
          content:
            name: GATEWAY_NETWORK_0_HOST
            value: ignition-scaleout-backend-0.ignition-scaleout-backend
      - contains:
          path: spec.template.spec.containers[0].env
          content:
            name: GATEWAY_NETWORK_1_HOST
            value: ignition-scaleout-backend-1.ignition-scaleout-backend

  - it: should inject only primary backend GAN host when backend redundancy is disabled
    set:
      backend:
        redundancy:
          enabled: false
    asserts:
      - contains:
          path: spec.template.spec.containers[0].env
          content:
            name: GATEWAY_NETWORK_0_HOST
            value: ignition-scaleout-backend-0.ignition-scaleout-backend
      - notContains:
          path: spec.template.spec.containers[0].env
          content:
            name: GATEWAY_NETWORK_1_HOST
