apiVersion: v1
kind: Secret
metadata:
  name: {{ include "ignition.name" . }}-config-files
  labels:
    {{- include "ignition.labels" . | nindent 4 }}
stringData:
  redundancy-primary.xml: |-
{{ include "ignition-common.redundancyXml" (dict "role" "Master" "host" (include "ignition-common.podFQDN" (dict "name" (printf "%s-backend" (include "ignition.name" .)) "ordinal" 1)) "port" .Values.backend.service.ports.gan "redundancy" .Values.backend.redundancy) | indent 4 }}
  redundancy-backup.xml: |-
{{ include "ignition-common.redundancyXml" (dict "role" "Backup" "host" (include "ignition-common.podFQDN" (dict "name" (printf "%s-backend" (include "ignition.name" .)) "ordinal" 0)) "port" .Values.backend.service.ports.gan "redundancy" .Values.backend.redundancy) | indent 4 }}

  {{- if .Values.frontend.spoofMachineId }}
  frontend-machine-id: |-
    {{ .Values.frontend.spoofMachineId }}
  {{- end }}
  {{- if .Values.backend.spoofMachineId }}
  backend-machine-id: |-
    {{ .Values.backend.spoofMachineId }}
  {{- end }}
  logback.xml: |-
{{ include "ignition-common.logback" (dict "level" .Values.backend.logging.level) | indent 4 }}
